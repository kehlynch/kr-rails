<div class="game">
  <%= form_with url: paths[:update_path], method: :patch, html: {id: "gameForm"}, class: 'game-container' do |form| %>
    <%= render(
      'state',
      local_assigns) %>
    <input id="js-stage" hidden=true name="game[action]" value=<%= action %> />

    <div class="instruction alert alert-primary" role="alert" id="instruction">
      <%= instruction %>
    </div>

    <%= render 'navigation_buttons', paths %>

    <div
      class="center-container spinner-border text-primary d-none"
      role="status"
      id="js-in-progress-spinner"
      >
      <span class="sr-only">Loading...</span>
    </div>

    <%= render 'message', message: message %>

    <%= render 'games/players/players', remarks: remarks, form: form %>

    <%= render(
      'valid_bid_buttons',
      visible: action == 'make_bid' && my_move,
      bids: valid_bids,
      type: 'bid') %>

    <%= render(
      'valid_bid_buttons',
      visible: visible_stage == 'announcement',
      bids: valid_announcements,
      type: 'announcement') %>

    <%= render 'hand', form: form %>

    <%= render 'kings', visible: visible_stage == 'pick_king', kings: kings  %>

    <%= render 'talon', talon: talon, visible: ['pick_talon', 'pick_whole_talon'].include?(visible_stage) %>

    <%= render 'tricks', tricks: tricks, form: form, visible: visible_stage == 'trick', visible_trick_index: visible_trick_index %>

    <%= render 'score', visible: visible_stage == 'finished' %>

    <%= render 'matches/points', visible: false %>

    <%= render 'finished_buttons', visible: visible_stage == 'finished', next_hand_path: paths[:next_hand_path] %>
  <% end %>
</div>
